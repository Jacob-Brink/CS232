#include <iostream>
#include "command.h"
#include "commandline.h"

using namespace std;

Command::Command() {
  argCount = { 0 };
  cout << "hello" << endl;
  cout << "argCount[0] = " << argCount[0] << endl;
}

Command::Command(vector<int> argCountParam, vector<string> argsParam, bool blockingParam) {
  argCount = {0, 1, 2}; //argCountParam;
  args = argsParam;
  blocking = blockingParam;
  
  cout << "Derive calling command constructor" << endl;
  cout << "argCount[0] = " << argCount[0] << endl;
};

bool Command::isValidCount() {
  
  cout << "isValidCount" << endl;
  cout << "argCount[0] = " << argCount[0] << endl;
  cout << argCount[0] << endl;
  for (int i : argCount) {
    if ((args.size()-1) == i) {
      return true;
    }
  }
  return false;
}

bool Command::isValidParam(vector<string> args) {
  return true; //should be overriden
}

bool Command::isValid() {
  if (!isValidCount()) {
    cout << "Given wrong number of parameters" << endl;
    return false;
  } else if (!isValidParam(args)) {
    cout << "Parameters are of incorrect type" << endl;
    return false;
  }
  return true;
}

void Command::execute() {
  
  cout << "execute" << endl;
  cout << "argCount[0] = " << this->argCount[0] << endl;
  // if (!isValid()) {
  //   cout << "Please try again!" << endl;
  //   return;
  // }

  if (blocking) {
    this->run(args);
  } else {
    // fork then run
  }
};

void Command::run(vector<string> args) {
  cout << "Command::run() not implemented" << endl;
};
